// Track setup calls for testing
const setupCalls = []

const setup = async({ app, cache, reporter }) => {
  const timestamp = Date.now()
  const setupData = {
    name: '@test-org/standard-plugin-a',
    timestamp,
    message: 'Standard Plugin A initialized'
  }

  // Track that setup was called
  setupCalls.push(setupData)

  // Store in app.ext for verification in tests
  if (!app.ext.testStandardPluginSetups) {
    app.ext.testStandardPluginSetups = []
  }
  app.ext.testStandardPluginSetups.push(setupData)

  reporter.log('Standard Plugin A setup complete')

  return setupData
}

const handlers = [{
  method: 'GET',
  path: '/test/standard-a',
  func: ({ setupData }) => (req, res) => {
    res.json({
      plugin: '@test-org/standard-plugin-a',
      setupData,
      message: 'Standard Plugin A handler response'
    })
  }
}]

module.exports = { setup, handlers, setupCalls }